import{i as T,g as A}from"./main-1YQrQUBq.js";import{b as L}from"./canvasService-BgNSt0fm.js";import{c as w,j as H}from"./utils-BVHWbP7o.js";let e=2025,u=500,d=500;const R=document.querySelector("main"),F=document.getElementById("drawHeader"),E=document.getElementById("drawTitle"),v=document.getElementById("canvas"),a=v.getContext("2d"),s=new URLSearchParams(window.location.search);let m=null,y="",o="",B="",S="",C=!1,b=!1,D="",i=[],t="",r="";T("Draw","Draw",!0).then(async()=>{e=A(),m=s.get("sentFrom");const l=s.get("username");if(l&&(o=l),m){if(m==="home"){const n=w("blue",`Back to the ${e} Overview`,"arrow_back");n.addEventListener("click",()=>window.location.href=`/?year=${e}`),F.appendChild(n),r=`The image below  contains all the pixels placed during Canvas ${e}`,t=`canvas${e}`}else if(m==="user"){const n=w("blue","Back to your stats","arrow_back");n.addEventListener("click",()=>window.location.href=`/user.html?year=${e}&user=${o}`),F.appendChild(n),r=`The image below contains all the pixels placed by ${o} during Canvas ${e}`,t=`${o}-pixels-${e}`}else if(m==="search"){const n=w("blue","Back to search","arrow_back");n.addEventListener("click",()=>window.location.href="/advanced-search.html"),F.appendChild(n),o?r=`The image below contains all the pixels placed by ${o} during Canvas ${e}`:r=`The image below contains all the pixels placed by ${o} during Canvas ${e}`,t=`${o}-pixels-${e}`}}const c=s.get("background");y=c||"white",s.get("undo")&&(C=!0,r+=" that were undone",t+="-undo");const p=s.get("color");p&&(S=I(p),r+=` that are ${p}`,t+=`${p}`);const $=s.get("isTop");$&&(D=$,r+=" that were visible at the end of the event",t+="-top-only");const g=s.get("special");g&&(B=g,g==="template"&&(r+=' that were included in the "megatemplate"',t+="-megatemplate"),g==="reverse"&&(b=!0,r+=" in reverse order",t+="-reverse"),g==="undo"&&(C=!0,r+=" that were undone",t+="-undo")),s.get("reverse")&&(b=!0,r+=" in reverse order",t+="-reverse");const k=await L(new H(e,C,o,S,B,D));k&&(i=k),e===2023?(d=1e3,u=1e3):e===2024?(d=500,u=1e3):e===2025&&(d=500,u=500),E.textContent=r;const x=document.getElementById("loading");if(x&&x.remove(),R.classList.remove("hide"),i.length>0){if(console.log(`Got ${i.length} pixels`),v.setAttribute("width",`${u}`),v.setAttribute("height",`${d}`),a)if(y==="black"?(a.fillStyle="#000000",a.fillRect(0,0,u,d)):y!=="transparent"&&(a.fillStyle="#ffffff",a.fillRect(0,0,u,d)),!b)i.forEach(f=>{setTimeout(()=>{a.fillStyle=f.colorHex,a.fillRect(f.xCoordinate,f.yCoordinate,1,1)},2e3)});else{const f=i.length-1;for(let h=f;h>=0;h--)setTimeout(()=>{a.fillStyle=i[h].colorHex,a.fillRect(i[h].xCoordinate,i[h].yCoordinate,1,1)},2e3)}const n=w("green",`Download ${t}`);n.addEventListener("click",()=>U()),F.appendChild(n)}else E.textContent="You have filtered out all the pixels!",console.log("no pixels")});function I(l){switch(l){case"white":return"#FFFFFF";case"light-grey":return"#B9C3CF";case"medium-grey":return"#777F8C";case"deep-grey":return"#424651";case"dark-grey":return"#1F1E26";case"black":return"#000000";case"dark-chocolate":return"#382215";case"chocolate":return"#7C3F20";case"brown":return"#C06F37";case"peach":return"#FEAD6C";case"beige":return"#FFD2B1";case"pink":return"#FFA4D0";case"magenta":return"#F14FB4";case"mauve":return"#E973FF";case"purple":return"#A630D2";case"dark-purple":return"#531D8C";case"navy":return"#242367";case"blue":return"#0334BF";case"azure":return"#149CFF";case"aqua":return"#8DF5FF";case"light-teal":return"#01BFA5";case"dark-teal":return"#16777E";case"forest":return"#054523";case"dark-green":return"#18862F";case"green":return"#61E021";case"lime":return"#B1FF37";case"pastel-yellow":return"#FFFFA5";case"yellow":return"#FDE111";case"orange":return"#FF9F17";case"rust":return"#F66E08";case"maroon":return"#550022";case"rose":return"#99011A";case"red":return"#F30F0C";case"watermelon":return"#FF7872";default:return"#000000"}}function U(){try{const l=v.toDataURL("image/png"),c=document.createElement("a");c.href=l,c.download=t+".png",c.click()}catch(l){console.error("Error during download:",l),console.error(`Error occurred while downloading ${t}.png`)}}
