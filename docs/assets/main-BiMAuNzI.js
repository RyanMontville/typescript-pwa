(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();const C=["/","/index","/users","/user","/faq","/advanced-search","/draw"],f=(t,e={})=>{const{replace:o=!1,params:n}=e,r="/typescript-pwa/",a=t.startsWith("/")?t.slice(1):t,i=`${r}${a}`,s=new URL(i,window.location.origin);n&&(n instanceof URLSearchParams?n.forEach((c,l)=>{s.searchParams.set(l,c)}):Object.entries(n).forEach(([c,l])=>{s.searchParams.set(c,String(l))})),o?window.location.replace(s.href):window.location.href=s.href},U=[2023,2024,2025],u="https://raw.githubusercontent.com/RyanMontville/typescript-pwa/refs/heads/main",A="https://raw.githubusercontent.com/TheRealMonte/images/refs/heads/main";let d=2025;const b=new URLSearchParams(window.location.search),m=b.get("year");m&&(d=isNaN(parseInt(m))?2025:parseInt(m));let I=b.get("search");const h=document.querySelector("body");async function x(t,e,o){e!==""&&(document.title=`${e} - Canvas Stats`),await new Promise(c=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>c(),{once:!0}):c()}),o&&await O(),await M(),await D(),await T(),await H();const n=document.querySelector("header"),r=document.querySelector("nav"),a=document.getElementById("search-group");n.classList.remove("hide"),r.classList.remove("hide"),a&&a.classList.remove("hide"),document.getElementById("logo-year").setAttribute("src",`${A}/${d}/logo${d}.png`),document.getElementById("changeYear").addEventListener("click",()=>{const c=document.getElementById("changeYearPopup"),l=document.createElement("h2");l.textContent="Select a year",c.appendChild(l);const S=U.reduce((g,y)=>{if(y!==d){const E=document.createElement("li"),w=document.createElement("button");return w.textContent=`${y}`,w.addEventListener("click",()=>{const L=new URLSearchParams(window.location.search);L.set("year",y.toString());const P=window.location.pathname.replace("/typescript-pwa/","/");($=>C.includes($))(P)?f(P,{params:L,replace:!0}):f("/",{params:L,replace:!0})}),E.appendChild(w),g.appendChild(E),g}return g},document.createElement("ul"));c.append(S);const v=document.getElementById("changeYearContainer");v.style.display="flex",v.classList.remove("hide")})}function B(){return d}function F(){return m!==null}function Y(){return I}async function p(t){try{const e=await fetch(t);if(!e.ok)throw console.error(`${e.status}: ${e.statusText}`),new Error("Error fetching header");return await e.text()}catch(e){console.error(`Error fethcing ${t}: ${e}`)}}async function D(t,e){try{const o=await p(u+"/templates/header.html");if(o){let n=document.createElement("header");n.setAttribute("class","hide"),n.innerHTML=o,h.prepend(n)}}catch(o){console.error(`Failed to load the header: ${o}`)}}async function M(){try{const t=await p(u+"/templates/nav.html");if(t){let e=document.createElement("nav");e.setAttribute("class","hide"),e.innerHTML=t,e.querySelector("#home").addEventListener("click",()=>f("/",{params:{year:d}})),h.prepend(e)}}catch(t){console.error(`Failed to load the nav: ${t}`)}}async function O(){try{const t=await p(u+"/templates/search.html");if(t){const e=document.createElement("form");e.setAttribute("class","search-form-group hide"),e.setAttribute("id","search-group"),e.innerHTML=t,e.addEventListener("submit",o=>{o.preventDefault();const r=new FormData(e).get("serch-input");r&&f("/users",{params:{search:r.toString()}})}),h.prepend(e)}}catch(t){console.error(`Failed to load the nav: ${t}`)}}async function T(){const t=document.getElementById("footer-placeholder");try{const e=await p(u+"/templates/footer.html");if(e){const o=document.createElement("footer");o.innerHTML=e,h.replaceChild(o,t)}}catch(e){console.error(`Failed to load the footer: ${e}`)}}async function H(){const t=document.getElementById("popup-placeholder");try{const e=await p(u+"/templates/popups.html");if(e){const o=document.createElement("div");o.innerHTML=e,h.replaceChild(o,t)}}catch(e){console.error(`Failed to load the popups: ${e}`)}}function q(t){const e=document.querySelectorAll("article");if(e.length>0){const o={root:null,rootMargin:"0px",threshold:.5},n=(a,i)=>{a.forEach(s=>{s.isIntersecting?(s.target.classList.add("show"),t&&i.unobserve(s.target)):s.target.classList.remove("show")})},r=new IntersectionObserver(n,o);e.forEach(a=>{r.observe(a)})}}export{Y as a,F as d,p as f,B as g,x as i,f as n,q as s};
