import{a as h,b as x,d as w}from"./canvasService-CrJZXPLr.js";import{f}from"./main-BiMAuNzI.js";import{g as y}from"./utils-BsKTqsVn.js";const p="https://raw.githubusercontent.com/TheRealMonte/data-files/refs/heads/main";async function U(){try{const o=await f(`${p}/allUsers.csv`);if(o){const t=o.trim().split(`
`),r=t[0].split(",").map(i=>i.trim()),n=r.indexOf("username"),s=r.indexOf("canvas2023"),a=r.indexOf("canvas2024"),e=r.indexOf("canvas2025"),l=[];for(let i=1;i<t.length;i++){const c=t[i].split(",");if(c.length===r.length){const m={type:"UserMain",username:c[n]?.trim()||"",canvas2023:+c[s]?.trim()==1||!1,canvas2024:+c[a]?.trim()==1||!1,canvas2025:+c[e]?.trim()==1||!1};l.push(m)}else console.warn(`Skipping row ${i+1} due to incorrect number of columns.`)}return l}else throw new Error("Could not fetch users csv")}catch(o){console.error(`Error creating user list: ${o}`)}}async function C(o){try{const t=await f(`${p}/${o}/users.csv`);if(t){const r=t.trim().split(`
`),n=r[0].split(",").map(u=>u.trim()),s=n.indexOf("username"),a=n.indexOf("userRank"),e=n.indexOf("numPixels"),l=n.indexOf("xCoordinateTop"),i=n.indexOf("yCoordinateTop"),c=n.indexOf("NumPixelsTop"),m=[];for(let u=1;u<r.length;u++){const d=r[u].split(",");if(d.length===n.length){const g={username:d[s]?.trim()||"",userRank:+d[a]?.trim()||0,pixelCount:+d[e]?.trim()||0,xCord:+d[l]?.trim()||0,yCord:+d[i]?.trim()||0,cordCount:+d[c]?.trim()||0};m.push(g)}else console.warn(`Skipping row ${u+1} due to incorrect number of columns.`)}return console.log("Loaded user data from csv"),m}}catch(t){console.error(`Error getting all user stats for ${o}: ${t}`)}}async function O(o,t){const r=await C(t),n=x(t);if(r){const s=r.find(a=>a.username===o);if(s)return{username:o,year:t,blocks:[{type:"standard",layout:"left",icon:"leaderboard",content:[`You ranked ${s.userRank} out of ${n} users in ${t}`]},{type:"user-color-grid",layout:"right",title:"Pixels by color",data:[]},{type:"standard",layout:"left",icon:"colors",content:[`You used ${await v(t,o)} out of the ${t===2023?"32":"34"} colors`]},{type:"standard",layout:"right",icon:"grid_view",content:[`You placed ${s.pixelCount} pixels throughout the event`]},{type:"standard",layout:"left",icon:"kid_star",content:[`The coordinate you placed the most pixels on was (${s.xCord}, ${s.yCord}) - ${s.cordCount} times (including the pixels you deleted)`]},{type:"graph",layout:"left",title:"Pixels Placed Per Hour"},{type:"button-group",layout:"left",title:"View your pixels placed in 2025",icon:"dashboard_customize",buttons:[{linkText:"on white background",classes:"white",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"white",username:o},external:!1},{linkText:"on black background",classes:"black",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"black",username:o},external:!1},{linkText:"on transparent background",classes:"dark-grey",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"transparent",username:o},external:!1}]}]}}return null}async function k(o){try{const t=await f(`${p}/${o}/color_count.csv`);if(t){const r=t.trim().split(`
`),n=r[0].split(",").map(a=>a.trim()),s=[];for(let a=1;a<r.length;a++){const e=r[a].split(",");if(e.length===n.length){const l={username:e[0]?.trim()||"",black:+e[1]?.trim()||0,darkGrey:+e[2]?.trim()||0,deepGrey:+e[3]?.trim()||0,mediumGrey:+e[4]?.trim()||0,lightGrey:+e[5]?.trim()||0,white:+e[6]?.trim()||0,beige:+e[7]?.trim()||0,peach:+e[8]?.trim()||0,brown:+e[9]?.trim()||0,chocolate:+e[10]?.trim()||0,rust:+e[11]?.trim()||0,orange:+e[12]?.trim()||0,yellow:+e[13]?.trim()||0,pastelYellow:+e[14]?.trim()||0,lime:+e[15]?.trim()||0,green:+e[16]?.trim()||0,darkGreen:+e[17]?.trim()||0,forest:+e[18]?.trim()||0,darkTeal:+e[19]?.trim()||0,lightTeal:+e[20]?.trim()||0,aqua:+e[21]?.trim()||0,azure:+e[22]?.trim()||0,blue:+e[23]?.trim()||0,navy:+e[24]?.trim()||0,purple:+e[25]?.trim()||0,mauve:+e[26]?.trim()||0,magenta:+e[27]?.trim()||0,pink:+e[28]?.trim()||0,watermelon:+e[29]?.trim()||0,red:+e[30]?.trim()||0,rose:+e[31]?.trim()||0,maroon:+e[32]?.trim()||0,darkChocolate:+e[33]?.trim()||0,darkPurple:+e[34]?.trim()||0};s.push(l)}else console.warn(`Skipping row ${a+1} due to incorrect number of columns.`)}return console.log("Loaded color count data"),s}return null}catch(t){return console.error(`Failed to fetch color counts: ${t}`),null}}async function b(o,t){const r=await k(o);if(r){let n=r.find(s=>s.username===t);if(n){const s=Object.keys(n),a=Object.values(n);s.shift(),a.shift();let e=[];return s.forEach((l,i)=>{if(a[i]>0){const c=l.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase(),m={class:l,label:c,hex:y(c),count:a[i]};e.push(m)}}),e.sort((l,i)=>i.count-l.count),e}}return null}async function v(o,t){const r=await b(o,t);return r?r.length:0}async function T(o,t){const r=await h(new w(o,t));if(r){if(r.length===0)return[];const n=[...r].sort((i,c)=>new Date(i.timePlaced).getTime()-new Date(c.timePlaced).getTime()),s=new Date(n[0].timePlaced),a=new Date(n[n.length-1].timePlaced);let e=new Date(s);e.setMinutes(0,0,0);const l=[];for(;e<=a;){const i=new Date(e);i.setHours(e.getHours()+1);const c=n.filter(m=>{const u=new Date(m.timePlaced);return u>=e&&u<i});l.push({timestamp:new Date(e.toISOString()),pixelCount:c.length}),e=i}return l}}export{b as G,C as a,T as b,O as c,U as g};
