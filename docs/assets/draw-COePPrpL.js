import{i as A,n as y,g as L}from"./main-BiMAuNzI.js";import{a as H,d as R}from"./canvasService-BDPeHYRM.js";import{a as F}from"./utils-BsKTqsVn.js";let e=2025,u=500,d=500;const I=document.querySelector("main"),w=document.getElementById("drawHeader"),B=document.getElementById("drawTitle"),v=document.getElementById("canvas"),n=v.getContext("2d"),s=new URLSearchParams(window.location.search);let h=null,C="",o="",S="",T="",b=!1,k=!1,D="",c=[],t="",r="";A("Draw","Draw",!0).then(async()=>{e=L(),h=s.get("sentFrom");const l=s.get("username");if(l&&(o=l),h){if(h==="home"){const a=F("blue",`Back to the ${e} Overview`,"arrow_back");a.addEventListener("click",()=>y("/",{params:{year:e}})),w.appendChild(a),r=`The image below  contains all the pixels placed during Canvas ${e}`,t=`canvas${e}`}else if(h==="user"){const a=F("blue","Back to your stats","arrow_back");a.addEventListener("click",()=>y("/user",{params:{year:e,user:o}})),w.appendChild(a),r=`The image below contains all the pixels placed by ${o} during Canvas ${e}`,t=`${o}-pixels-${e}`}else if(h==="search"){const a=F("blue","Back to search","arrow_back");a.addEventListener("click",()=>y("/advanced-search")),w.appendChild(a),o?r=`The image below contains all the pixels placed by ${o} during Canvas ${e}`:r=`The image below contains all the pixels placed by ${o} during Canvas ${e}`,t=`${o}-pixels-${e}`}}const i=s.get("background");C=i||"white",s.get("undo")&&(b=!0,r+=" that were undone",t+="-undo");const p=s.get("color");p&&(T=U(p),r+=` that are ${p}`,t+=`${p}`);const $=s.get("isTop");$&&(D=$,r+=" that were visible at the end of the event",t+="-top-only");const g=s.get("special");g&&(S=g,g==="template"&&(r+=' that were included in the "megatemplate"',t+="-megatemplate"),g==="reverse"&&(k=!0,r+=" in reverse order",t+="-reverse"),g==="undo"&&(b=!0,r+=" that were undone",t+="-undo")),s.get("reverse")&&(k=!0,r+=" in reverse order",t+="-reverse");const x=await H(new R(e,o,b,T,S,D));x&&(c=x),e===2023?(d=1e3,u=1e3):e===2024?(d=500,u=1e3):e===2025&&(d=500,u=500),B.textContent=r;const E=document.getElementById("loading");if(E&&E.remove(),I.classList.remove("hide"),c.length>0){if(console.log(`Got ${c.length} pixels`),v.setAttribute("width",`${u}`),v.setAttribute("height",`${d}`),n)if(C==="black"?(n.fillStyle="#000000",n.fillRect(0,0,u,d)):C!=="transparent"&&(n.fillStyle="#ffffff",n.fillRect(0,0,u,d)),!k)c.forEach(m=>{setTimeout(()=>{n.fillStyle=m.colorHex,n.fillRect(m.xCoordinate,m.yCoordinate,1,1)},2e3)});else{const m=c.length-1;for(let f=m;f>=0;f--)setTimeout(()=>{n.fillStyle=c[f].colorHex,n.fillRect(c[f].xCoordinate,c[f].yCoordinate,1,1)},2e3)}const a=F("green",`Download ${t}`);a.addEventListener("click",()=>P()),w.appendChild(a)}else B.textContent="You have filtered out all the pixels!",console.log("no pixels")});function U(l){switch(l){case"white":return"#FFFFFF";case"light-grey":return"#B9C3CF";case"medium-grey":return"#777F8C";case"deep-grey":return"#424651";case"dark-grey":return"#1F1E26";case"black":return"#000000";case"dark-chocolate":return"#382215";case"chocolate":return"#7C3F20";case"brown":return"#C06F37";case"peach":return"#FEAD6C";case"beige":return"#FFD2B1";case"pink":return"#FFA4D0";case"magenta":return"#F14FB4";case"mauve":return"#E973FF";case"purple":return"#A630D2";case"dark-purple":return"#531D8C";case"navy":return"#242367";case"blue":return"#0334BF";case"azure":return"#149CFF";case"aqua":return"#8DF5FF";case"light-teal":return"#01BFA5";case"dark-teal":return"#16777E";case"forest":return"#054523";case"dark-green":return"#18862F";case"green":return"#61E021";case"lime":return"#B1FF37";case"pastel-yellow":return"#FFFFA5";case"yellow":return"#FDE111";case"orange":return"#FF9F17";case"rust":return"#F66E08";case"maroon":return"#550022";case"rose":return"#99011A";case"red":return"#F30F0C";case"watermelon":return"#FF7872";default:return"#000000"}}function P(){try{const l=v.toDataURL("image/png"),i=document.createElement("a");i.href=l,i.download=t+".png",i.click()}catch(l){console.error("Error during download:",l),console.error(`Error occurred while downloading ${t}.png`)}}
