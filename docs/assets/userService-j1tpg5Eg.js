import{a as $,i as y,P as p,C as h,U as f}from"./utils-BVHWbP7o.js";import{a as k}from"./canvasService-1HiiuAQ0.js";import{f as w}from"./main-D2Ctbpwk.js";const C="https://raw.githubusercontent.com/TheRealMonte/data-files/refs/heads/main";async function D(){try{const r=await w(`${C}/allUsers.csv`);if(r){const e=r.trim().split(`
`),n=e[0].split(",").map(i=>i.trim()),a=n.indexOf("username"),s=n.indexOf("canvas2023"),o=n.indexOf("canvas2024"),t=n.indexOf("canvas2025"),c=[];for(let i=1;i<e.length;i++){const l=e[i].split(",");if(l.length===n.length){const d={type:"UserMain",username:l[a]?.trim()||"",canvas2023:+l[s]?.trim()==1||!1,canvas2024:+l[o]?.trim()==1||!1,canvas2025:+l[t]?.trim()==1||!1};c.push(d)}else console.warn(`Skipping row ${i+1} due to incorrect number of columns.`)}return c}else throw new Error("Could not fetch users csv")}catch(r){console.error(`Error creating user list: ${r}`)}}async function S(r){try{const e=await w(`${C}/${r}/users.csv`);if(e){const n=e.trim().split(`
`),a=n[0].split(",").map(m=>m.trim()),s=a.indexOf("username"),o=a.indexOf("userRank"),t=a.indexOf("numPixels"),c=a.indexOf("xCoordinateTop"),i=a.indexOf("yCoordinateTop"),l=a.indexOf("NumPixelsTop"),d=[];for(let m=1;m<n.length;m++){const u=n[m].split(",");if(u.length===a.length){const g={type:"User",username:u[s]?.trim()||"",userRank:+u[o]?.trim()||0,pixelCount:+u[t]?.trim()||0,xCord:+u[c]?.trim()||0,yCord:+u[i]?.trim()||0,cordCount:+u[l]?.trim()||0};d.push(g)}else console.warn(`Skipping row ${m+1} due to incorrect number of columns.`)}return console.log("Loaded user data from csv"),d}}catch(e){console.error(`Error getting all user stats for ${r}: ${e}`)}}function U(r){const e=r%100;if(e>=11&&e<=13)return r+"th";switch(r%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd";default:return r+"th"}}async function G(r,e){const n=await S(e),a=k(e);if(n){const s=n.find(o=>o.username===r);if(s){let o=[];const t=new p([new h("text",`You ranked ${s.userRank} out of ${a} users in ${e}`)]),c=new f("left","text",U(s.userRank),t);o.push(c);const i=new f("right","","colorCount",{parts:[]});o.push(i);const l=new p([new h("text",`You used ${await O(e,r)} out of the ${e===2023?"32":"34"} colors`)]),d=new f("left","icon","colors",l);o.push(d);const m=new p([new h("text",`You placed ${s.pixelCount} pixels throughout the event`)]),u=new f("right","icon","grid_view",m);o.push(u);const g=new p([new h("text",`The coordinate you placed the most pixels on was (${s.xCord}, ${s.yCord}) - ${s.cordCount} times (including the pixels you deleted)`)]),x=new f("left","icon","kid_star",g);o.push(x);const v=new f("right","","drawLinks",{parts:[]});return o.push(v),o}}return null}async function b(r){try{const e=await w(`${C}/${r}/color_count.csv`);if(e){const n=e.trim().split(`
`),a=n[0].split(",").map(o=>o.trim()),s=[];for(let o=1;o<n.length;o++){const t=n[o].split(",");if(t.length===a.length){const c={username:t[0]?.trim()||"",black:+t[1]?.trim()||0,darkGrey:+t[2]?.trim()||0,deepGrey:+t[3]?.trim()||0,mediumGrey:+t[4]?.trim()||0,lightGrey:+t[5]?.trim()||0,white:+t[6]?.trim()||0,beige:+t[7]?.trim()||0,peach:+t[8]?.trim()||0,brown:+t[9]?.trim()||0,chocolate:+t[10]?.trim()||0,rust:+t[11]?.trim()||0,orange:+t[12]?.trim()||0,yellow:+t[13]?.trim()||0,pastelYellow:+t[14]?.trim()||0,lime:+t[15]?.trim()||0,green:+t[16]?.trim()||0,darkGreen:+t[17]?.trim()||0,forest:+t[18]?.trim()||0,darkTeal:+t[19]?.trim()||0,lightTeal:+t[20]?.trim()||0,aqua:+t[21]?.trim()||0,azure:+t[22]?.trim()||0,blue:+t[23]?.trim()||0,navy:+t[24]?.trim()||0,purple:+t[25]?.trim()||0,mauve:+t[26]?.trim()||0,magenta:+t[27]?.trim()||0,pink:+t[28]?.trim()||0,watermelon:+t[29]?.trim()||0,red:+t[30]?.trim()||0,rose:+t[31]?.trim()||0,maroon:+t[32]?.trim()||0,darkChocolate:+t[33]?.trim()||0,darkPurple:+t[34]?.trim()||0};s.push(c)}else console.warn(`Skipping row ${o+1} due to incorrect number of columns.`)}return console.log("Loaded color count data"),s}return null}catch(e){return console.error(`Failed to fetch color counts: ${e}`),null}}async function P(r,e){const n=await b(r);if(n){let a=n.find(s=>s.username===e);if(a){const s=Object.keys(a),o=Object.values(a);s.shift(),o.shift();let t=[];return s.forEach((c,i)=>{if(o[i]>0){const l=c.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase();t.push(new $(y(l),l,o[i]))}}),t.sort((c,i)=>i.count-c.count),t}}return null}async function O(r,e){const n=await P(r,e);return n?n.length:0}export{P as G,S as a,G as b,D as g};
