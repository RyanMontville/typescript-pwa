(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();const I=[2023,2024,2025],d="https://raw.githubusercontent.com/RyanMontville/typescript-pwa/refs/heads/main",D="https://raw.githubusercontent.com/TheRealMonte/images/refs/heads/main";let s=2025;const E=new URLSearchParams(window.location.search),m=E.get("year");m&&(s=isNaN(parseInt(m))?2025:parseInt(m));let M=E.get("search");const u=document.querySelector("body");async function T(t,e,o){e!==""&&(document.title=`${e} - Canvas Stats`),await new Promise(l=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>l(),{once:!0}):l()}),o&&await O(),await U(),await A(),await B(),await F();const a=document.querySelector("header"),r=document.querySelector("nav"),n=document.getElementById("search-group");a.classList.remove("hide"),r.classList.remove("hide"),n&&n.classList.remove("hide"),document.getElementById("logo-year").setAttribute("src",`${D}/${s}/logo${s}.png`),document.getElementById("changeYear").addEventListener("click",()=>{const l=document.getElementById("changeYearPopup"),w=document.createElement("h2");w.textContent="Select a year",l.appendChild(w);const L=I.reduce((p,f)=>{if(f!==s){const v=document.createElement("li"),g=document.createElement("button");return g.textContent=`${f}`,g.addEventListener("click",()=>{let $=window.location.href.split("?")[0],y=window.location.href.split("?")[1].split("&");y.forEach((S,C)=>{S.split("=")[0]==="year"&&(y[C]=`year=${f}`)});const P=y.join("&");window.location.href=`${$}?${P}`}),v.appendChild(g),p.appendChild(v),p}return p},document.createElement("ul"));l.append(L);const b=document.getElementById("changeYearContainer");b.style.display="flex"})}function Y(){return s}function x(){return m!==null}function q(){return M}async function h(t){try{const e=await fetch(t);if(!e.ok)throw console.error(`${e.status}: ${e.statusText}`),new Error("Error fetching header");return await e.text()}catch(e){console.error(`Error fethcing ${t}: ${e}`)}}async function A(t,e){try{const o=await h(d+"/templates/header.html");if(o){let a=document.createElement("header");a.setAttribute("class","hide"),a.innerHTML=o,u.prepend(a)}}catch(o){console.error(`Failed to load the header: ${o}`)}}async function U(){try{const t=await h(d+"/templates/nav.html");if(t){let e=document.createElement("nav");e.setAttribute("class","hide"),e.innerHTML=t,e.querySelector("#home").setAttribute("href",`/?year=${s}`),u.prepend(e)}}catch(t){console.error(`Failed to load the nav: ${t}`)}}async function O(){try{const t=await h(d+"/templates/search.html");if(t){const e=document.createElement("form");e.setAttribute("class","search-form-group hide"),e.setAttribute("id","search-group"),e.innerHTML=t,e.addEventListener("submit",o=>{o.preventDefault();const r=new FormData(e).get("serch-input");window.location.href=`users?search=${r}`}),u.prepend(e)}}catch(t){console.error(`Failed to load the nav: ${t}`)}}async function B(){const t=document.getElementById("footer-placeholder");try{const e=await h(d+"/templates/footer.html");if(e){const o=document.createElement("footer");o.innerHTML=e,u.replaceChild(o,t)}}catch(e){console.error(`Failed to load the footer: ${e}`)}}async function F(){const t=document.getElementById("popup-placeholder");try{const e=await h(d+"/templates/popups.html");if(e){const o=document.createElement("div");o.innerHTML=e,u.replaceChild(o,t)}}catch(e){console.error(`Failed to load the popups: ${e}`)}}function N(t){const e=document.querySelectorAll("article");if(e.length>0){const o={root:null,rootMargin:"0px",threshold:.5},a=(n,c)=>{n.forEach(i=>{i.isIntersecting?(i.target.classList.add("show"),t&&c.unobserve(i.target)):i.target.classList.remove("show")})},r=new IntersectionObserver(a,o);e.forEach(n=>{r.observe(n)})}}export{q as a,x as d,h as f,Y as g,T as i,N as s};
