(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();const M=[2023,2024,2025];let l=2025;const v=new URLSearchParams(window.location.search),p=v.get("year");p&&(l=isNaN(parseInt(p))?2025:parseInt(p));let C=v.get("search");const d=document.querySelector("body");async function H(t,e,o){e!==""&&(document.title=`${e} - Canvas Stats`),await new Promise(i=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>i(),{once:!0}):i()}),o&&await A(),await D(),await I(),await O(),await B();const a=document.querySelector("header"),r=document.querySelector("nav"),n=document.getElementById("search-group");a.classList.remove("hide"),r.classList.remove("hide"),n&&n.classList.remove("hide"),document.getElementById("logo-year").setAttribute("src",`images/logo${l}.png`),document.getElementById("changeYear").addEventListener("click",()=>{const i=document.getElementById("changeYearPopup"),g=document.createElement("h2");g.textContent="Select a year",i.appendChild(g);const E=M.reduce((h,m)=>{if(m!==l){const w=document.createElement("li"),f=document.createElement("button");return f.textContent=`${m}`,f.addEventListener("click",()=>{let b=window.location.href.split("?")[0],y=window.location.href.split("?")[1].split("&");y.forEach(($,S)=>{$.split("=")[0]==="year"&&(y[S]=`year=${m}`)});const P=y.join("&");window.location.href=`${b}?${P}`}),w.appendChild(f),h.appendChild(w),h}return h},document.createElement("ul"));i.append(E);const L=document.getElementById("changeYearContainer");L.style.display="flex"})}function U(){return l}function Y(){return p!==null}function x(){return C}async function u(t){try{const e=await fetch(t);if(!e.ok)throw console.error(`${e.status}: ${e.statusText}`),new Error("Error fetching header");return await e.text()}catch(e){console.error(`Error fethcing ${t}: ${e}`)}}async function I(t,e){try{const o=await u("https://raw.githubusercontent.com/RyanMontville/typescript-pwa/refs/heads/main/templates/header.html");if(o){let a=document.createElement("header");a.setAttribute("class","hide"),a.innerHTML=o,d.prepend(a)}}catch(o){console.error(`Failed to load the header: ${o}`)}}async function D(){try{const t=await u("https://raw.githubusercontent.com/RyanMontville/typescript-pwa/refs/heads/main/templates/nav.html");if(t){let e=document.createElement("nav");e.setAttribute("class","hide"),e.innerHTML=t,e.querySelector("#home").setAttribute("href",`/?year=${l}`),d.prepend(e)}}catch(t){console.error(`Failed to load the nav: ${t}`)}}async function A(){try{const t=await u("https://raw.githubusercontent.com/RyanMontville/typescript-pwa/refs/heads/main/templates/search.html");if(t){const e=document.createElement("form");e.setAttribute("class","search-form-group hide"),e.setAttribute("id","search-group"),e.innerHTML=t,e.addEventListener("submit",o=>{o.preventDefault();const r=new FormData(e).get("serch-input");window.location.href=`users?search=${r}`}),d.prepend(e)}}catch(t){console.error(`Failed to load the nav: ${t}`)}}async function O(){const t=document.getElementById("footer-placeholder");try{const e=await u("https://raw.githubusercontent.com/RyanMontville/typescript-pwa/refs/heads/main/templates/footer.html");if(e){const o=document.createElement("footer");o.innerHTML=e,d.replaceChild(o,t)}}catch(e){console.error(`Failed to load the footer: ${e}`)}}async function B(){const t=document.getElementById("popup-placeholder");try{const e=await u("https://raw.githubusercontent.com/RyanMontville/typescript-pwa/refs/heads/main/templates/popups.html");if(e){const o=document.createElement("div");o.innerHTML=e,d.replaceChild(o,t)}}catch(e){console.error(`Failed to load the popups: ${e}`)}}function R(t){const e=document.querySelectorAll("article");if(e.length>0){const o={root:null,rootMargin:"0px",threshold:.5},a=(n,s)=>{n.forEach(c=>{c.isIntersecting?(c.target.classList.add("show"),t&&s.unobserve(c.target)):c.target.classList.remove("show")})},r=new IntersectionObserver(a,o);e.forEach(n=>{r.observe(n)})}}export{x as a,Y as d,u as f,U as g,H as i,R as s};
