import{a as x,b as w,d as y}from"./canvasService-CrJZXPLr.js";import{f as p}from"./main-BiMAuNzI.js";import{g as C}from"./utils-BsKTqsVn.js";const g="https://raw.githubusercontent.com/TheRealMonte/data-files/refs/heads/main";async function F(){try{const o=await p(`${g}/allUsers.csv`);if(o){const t=o.trim().split(`
`),r=t[0].split(",").map(l=>l.trim()),a=r.indexOf("username"),n=r.indexOf("canvas2023"),s=r.indexOf("canvas2024"),e=r.indexOf("canvas2025"),u=[];for(let l=1;l<t.length;l++){const i=t[l].split(",");if(i.length===r.length){const d={type:"UserMain",username:i[a]?.trim()||"",canvas2023:+i[n]?.trim()==1||!1,canvas2024:+i[s]?.trim()==1||!1,canvas2025:+i[e]?.trim()==1||!1};u.push(d)}else console.warn(`Skipping row ${l+1} due to incorrect number of columns.`)}return u}else throw new Error("Could not fetch users csv")}catch(o){console.error(`Error creating user list: ${o}`)}}async function k(o){try{const t=await p(`${g}/${o}/users.csv`);if(t){const r=t.trim().split(`
`),a=r[0].split(",").map(c=>c.trim()),n=a.indexOf("username"),s=a.indexOf("userRank"),e=a.indexOf("numPixels"),u=a.indexOf("xCoordinateTop"),l=a.indexOf("yCoordinateTop"),i=a.indexOf("NumPixelsTop"),d=[];for(let c=1;c<r.length;c++){const m=r[c].split(",");if(m.length===a.length){const f={username:m[n]?.trim()||"",userRank:+m[s]?.trim()||0,pixelCount:+m[e]?.trim()||0,xCord:+m[u]?.trim()||0,yCord:+m[l]?.trim()||0,cordCount:+m[i]?.trim()||0};d.push(f)}else console.warn(`Skipping row ${c+1} due to incorrect number of columns.`)}return console.log("Loaded user data from csv"),d}}catch(t){console.error(`Error getting all user stats for ${o}: ${t}`)}}async function O(o,t){const r=await k(t),a=w(t);if(r){const n=r.find(s=>s.username===o);if(n)return{username:o,year:t,blocks:[{type:"standard",layout:"left",icon:"leaderboard",content:[`You ranked ${n.userRank} out of ${a} users in ${t}`]},{type:"user-color-grid",layout:"right",title:"Pixels by color",data:[]},{type:"standard",layout:"left",icon:"colors",content:[`You used ${await v(t,o)} out of the ${t===2023?"32":"34"} colors`]},{type:"standard",layout:"right",icon:"grid_view",content:[`You placed ${n.pixelCount} pixels throughout the event`]},{type:"standard",layout:"left",icon:"kid_star",content:[`The coordinate you placed the most pixels on was (${n.xCord}, ${n.yCord}) - ${n.cordCount} times (including the pixels you deleted)`]},{type:"graph",layout:"left",title:"Pixels Placed Per Hour"},{type:"button-group",layout:"left",title:"View your pixels placed in 2025",icon:"dashboard_customize",buttons:[{linkText:"on white background",classes:"white",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"white",username:o},external:!1},{linkText:"on black background",classes:"black",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"black",username:o},external:!1},{linkText:"on transparent background",classes:"dark-grey",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"transparent",username:o},external:!1}]}]}}return null}async function b(o){try{const t=await p(`${g}/${o}/color_count.csv`);if(t){const r=t.trim().split(`
`),a=r[0].split(",").map(s=>s.trim()),n=[];for(let s=1;s<r.length;s++){const e=r[s].split(",");if(e.length===a.length){const u={username:e[0]?.trim()||"",black:+e[1]?.trim()||0,darkGrey:+e[2]?.trim()||0,deepGrey:+e[3]?.trim()||0,mediumGrey:+e[4]?.trim()||0,lightGrey:+e[5]?.trim()||0,white:+e[6]?.trim()||0,beige:+e[7]?.trim()||0,peach:+e[8]?.trim()||0,brown:+e[9]?.trim()||0,chocolate:+e[10]?.trim()||0,rust:+e[11]?.trim()||0,orange:+e[12]?.trim()||0,yellow:+e[13]?.trim()||0,pastelYellow:+e[14]?.trim()||0,lime:+e[15]?.trim()||0,green:+e[16]?.trim()||0,darkGreen:+e[17]?.trim()||0,forest:+e[18]?.trim()||0,darkTeal:+e[19]?.trim()||0,lightTeal:+e[20]?.trim()||0,aqua:+e[21]?.trim()||0,azure:+e[22]?.trim()||0,blue:+e[23]?.trim()||0,navy:+e[24]?.trim()||0,purple:+e[25]?.trim()||0,mauve:+e[26]?.trim()||0,magenta:+e[27]?.trim()||0,pink:+e[28]?.trim()||0,watermelon:+e[29]?.trim()||0,red:+e[30]?.trim()||0,rose:+e[31]?.trim()||0,maroon:+e[32]?.trim()||0,darkChocolate:+e[33]?.trim()||0,darkPurple:+e[34]?.trim()||0};n.push(u)}else console.warn(`Skipping row ${s+1} due to incorrect number of columns.`)}return console.log("Loaded color count data"),n}return null}catch(t){return console.error(`Failed to fetch color counts: ${t}`),null}}async function P(o,t){const r=await b(o);if(r){let a=r.find(n=>n.username===t);if(a){const n=Object.keys(a),s=Object.values(a);n.shift(),s.shift();let e=[];return n.forEach((u,l)=>{if(s[l]>0){const i=u.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase(),d={class:u,label:i,hex:C(i),count:s[l]};e.push(d)}}),e.sort((u,l)=>l.count-u.count),e}}return null}async function v(o,t){const r=await P(o,t);return r?r.length:0}async function T(o,t){const r=await x(new y(o));if(r){const a=r[0],n=r[r.length-1],s=r.filter(c=>c.username===t);if(s.length===0)return[];const e=[...s].sort((c,m)=>new Date(c.timePlaced).getTime()-new Date(m.timePlaced).getTime()),u=new Date(a.timePlaced),l=new Date(n.timePlaced);let i=new Date(u);i.setMinutes(0,0,0);const d=[];for(;i<=l;){const c=new Date(i);c.setHours(i.getHours()+1);const m=e.filter(f=>{const h=new Date(f.timePlaced);return h>=i&&h<c});d.push({timestamp:new Date(i.toISOString()),pixelCount:m.length}),i=c}return d}}export{P as G,k as a,T as b,O as c,F as g};
