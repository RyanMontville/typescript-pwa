import{a as h,b as x,c as w,d as y}from"./canvasService-BDPeHYRM.js";import{f}from"./main-BiMAuNzI.js";import{g as C}from"./utils-BsKTqsVn.js";const p="https://raw.githubusercontent.com/TheRealMonte/data-files/refs/heads/main";async function O(){try{const o=await f(`${p}/allUsers.csv`);if(o){const t=o.trim().split(`
`),r=t[0].split(",").map(l=>l.trim()),n=r.indexOf("username"),s=r.indexOf("canvas2023"),a=r.indexOf("canvas2024"),e=r.indexOf("canvas2025"),i=[];for(let l=1;l<t.length;l++){const c=t[l].split(",");if(c.length===r.length){const u={type:"UserMain",username:c[n]?.trim()||"",canvas2023:+c[s]?.trim()==1||!1,canvas2024:+c[a]?.trim()==1||!1,canvas2025:+c[e]?.trim()==1||!1};i.push(u)}else console.warn(`Skipping row ${l+1} due to incorrect number of columns.`)}return i}else throw new Error("Could not fetch users csv")}catch(o){console.error(`Error creating user list: ${o}`)}}async function k(o){try{const t=await f(`${p}/${o}/users.csv`);if(t){const r=t.trim().split(`
`),n=r[0].split(",").map(d=>d.trim()),s=n.indexOf("username"),a=n.indexOf("userRank"),e=n.indexOf("numPixels"),i=n.indexOf("xCoordinateTop"),l=n.indexOf("yCoordinateTop"),c=n.indexOf("NumPixelsTop"),u=[];for(let d=1;d<r.length;d++){const m=r[d].split(",");if(m.length===n.length){const g={username:m[s]?.trim()||"",userRank:+m[a]?.trim()||0,pixelCount:+m[e]?.trim()||0,xCord:+m[i]?.trim()||0,yCord:+m[l]?.trim()||0,cordCount:+m[c]?.trim()||0};u.push(g)}else console.warn(`Skipping row ${d+1} due to incorrect number of columns.`)}return console.log("Loaded user data from csv"),u}}catch(t){console.error(`Error getting all user stats for ${o}: ${t}`)}}async function T(o,t){const r=await k(t),n=w(t);if(r){const s=r.find(a=>a.username===o);if(s)return{username:o,year:t,blocks:[{type:"standard",layout:"left",icon:"leaderboard",content:[`You ranked ${s.userRank} out of ${n} users in ${t}`]},{type:"user-color-grid",layout:"right",title:"Pixels by color",data:[]},{type:"standard",layout:"left",icon:"colors",content:[`You used ${await v(t,o)} out of the ${t===2023?"32":"34"} colors`]},{type:"standard",layout:"right",icon:"grid_view",content:[`You placed ${s.pixelCount} pixels throughout the event`]},{type:"standard",layout:"left",icon:"kid_star",content:[`The coordinate you placed the most pixels on was (${s.xCord}, ${s.yCord}) - ${s.cordCount} times (including the pixels you deleted)`]},{type:"graph",layout:"left",title:"Pixels Placed Per Hour"},{type:"button-group",layout:"left",title:"View your pixels placed in 2025",icon:"dashboard_customize",buttons:[{linkText:"on white background",classes:"white",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"white",username:o},external:!1},{linkText:"on black background",classes:"black",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"black",username:o},external:!1},{linkText:"on transparent background",classes:"dark-grey",page:"/draw",queryParams:{sentFrom:"user",year:t,background:"transparent",username:o},external:!1}]}]}}return null}async function b(o){try{const t=await f(`${p}/${o}/color_count.csv`);if(t){const r=t.trim().split(`
`),n=r[0].split(",").map(a=>a.trim()),s=[];for(let a=1;a<r.length;a++){const e=r[a].split(",");if(e.length===n.length){const i={username:e[0]?.trim()||"",black:+e[1]?.trim()||0,darkGrey:+e[2]?.trim()||0,deepGrey:+e[3]?.trim()||0,mediumGrey:+e[4]?.trim()||0,lightGrey:+e[5]?.trim()||0,white:+e[6]?.trim()||0,beige:+e[7]?.trim()||0,peach:+e[8]?.trim()||0,brown:+e[9]?.trim()||0,chocolate:+e[10]?.trim()||0,rust:+e[11]?.trim()||0,orange:+e[12]?.trim()||0,yellow:+e[13]?.trim()||0,pastelYellow:+e[14]?.trim()||0,lime:+e[15]?.trim()||0,green:+e[16]?.trim()||0,darkGreen:+e[17]?.trim()||0,forest:+e[18]?.trim()||0,darkTeal:+e[19]?.trim()||0,lightTeal:+e[20]?.trim()||0,aqua:+e[21]?.trim()||0,azure:+e[22]?.trim()||0,blue:+e[23]?.trim()||0,navy:+e[24]?.trim()||0,purple:+e[25]?.trim()||0,mauve:+e[26]?.trim()||0,magenta:+e[27]?.trim()||0,pink:+e[28]?.trim()||0,watermelon:+e[29]?.trim()||0,red:+e[30]?.trim()||0,rose:+e[31]?.trim()||0,maroon:+e[32]?.trim()||0,darkChocolate:+e[33]?.trim()||0,darkPurple:+e[34]?.trim()||0};s.push(i)}else console.warn(`Skipping row ${a+1} due to incorrect number of columns.`)}return console.log("Loaded color count data"),s}return null}catch(t){return console.error(`Failed to fetch color counts: ${t}`),null}}async function P(o,t){const r=await b(o);if(r){let n=r.find(s=>s.username===t);if(n){const s=Object.keys(n),a=Object.values(n);s.shift(),a.shift();let e=[];return s.forEach((i,l)=>{if(a[l]>0){const c=i.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase(),u={class:i,label:c,hex:C(c),count:a[l]};e.push(u)}}),e.sort((i,l)=>l.count-i.count),e}}return null}async function v(o,t){const r=await P(o,t);return r?r.length:0}async function I(o,t){const r=await h(new y(o,t)),n=await x(o);if(r&&n){if(r.length===0)return[];const s=[...r].sort((c,u)=>new Date(c.timePlaced).getTime()-new Date(u.timePlaced).getTime()),a=new Date(n[0].timePlaced),e=new Date(n[1].timePlaced);let i=new Date(a);i.setMinutes(0,0,0);const l=[];for(;i<=e;){const c=new Date(i);c.setHours(i.getHours()+1);const u=s.filter(d=>{const m=new Date(d.timePlaced);return m>=i&&m<c});l.push({timestamp:new Date(i.toISOString()),pixelCount:u.length}),i=c}return l}}export{P as G,k as a,I as b,T as c,O as g};
